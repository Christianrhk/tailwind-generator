<!doctype html>
<html lang="en" class="light">
  <head>
    <title>Webpacker and Rails 6 ||  R3ID</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="last-modified" content="2022-06-28">
    <meta name="description" content="A software engineer based in Hertfordshire who specializes in developing (and occasionally designing) exceptional, high-quality websites and applications.">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.1.1/tailwind.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" />
    <link rel="stylesheet" href="/assets/css/main.css" media="screen">
    <link rel="stylesheet" href="/assets/css/main.css" media="print">
    <link rel="icon" type="image/png" href="https://r3id.dev/favicon.ico">
  </head>
  <body class="home-page text-gray-500">

    <nav class="max-w-5xl m-auto p-5 flex justify-between border-solid border-b border-gray-100 bg-white dark:border-black dark:bg-blackish sticky top-0 opacity-90 z-10">
  <div class="flex items-center">
    <a href="/" class="transition-colors">
      <i class="far fa-arrow-left text-sm text-glow hover:text-gray-700"></i>
    </a>
  </div>
</nav>




<div class="default-container">
  <div class="pt-20 pb-1 inline-flex overflow-x-auto space-x-2">
		<a href="/">
			<p class="cursor-pointer text-sm text-gray-400 dark:text-gray-600 hover:font-medium hover:text-gray-700 dark:hover:text-gray-300 min-w-max">Home /</p>
		</a>
    <a href="/notes">
			<p class="cursor-pointer text-sm text-gray-400 dark:text-gray-600 hover:font-medium hover:text-gray-700 dark:hover:text-gray-300 min-w-max">Notes to self /</p>
		</a>
		<a href="/notes/webpacker">
			<p class="cursor-pointer text-sm text-glow dark:text-glow hover:font-medium hover:text-gray-700 dark:hover:text-gray-300 min-w-max">Webpacker and Rails 6</p>
		</a>
	</div>
	<div class="mb-6">
		<h1 class="pb-2 font-bold text-3xl text-gray-600">Webpacker and Rails 6</h1>
    
      <p class="text-sm italic mb-4">It's a 5 minute read</p>
    
	</div>
  <div class="text-content">
    <p>When Rails 6 was released Webpacker became the default JavaScript compiler instead of Sprockets. Meaning that moving forward all javascript code will be compiled with the help of webpack by default.</p>

<div class="image-center">
  <svg width="80px" height="76px" viewBox="0 0 80 76" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
      <path d="M76.2,22.2 C75.5,20 74.6,18 72.6,16.7 C70.8,15.5 69,14.4 67.3,13.2 C66.9,12.9 64,11.2 62.8,10.9 C60.4,10.2 54.1,4.4 53.3,4.1 C45.5,0.3 37.4,-0.3 29.3,2.8 C28,3.3 20.3,7.1 20.3,7.1 C18.7,8.8 11.3,13.7 9.3,15.3 C7.5,16.7 5.9,18.3 4.1,19.6 C1.6,21.6 0.6,24.1 1,27.2 C1,27.5 1,27.9 1,28.3 C1.1,31.4 1.2,34.6 1.3,37.7 C1.3,41.7 1.3,45.7 1.3,49.7 C1.4,55.7 4.2,60.3 9.3,63.3 C11.5,64.7 13.9,65.9 16.3,66.9 C20.2,68.5 24.3,69.9 28.3,71.4 C30.2,72.1 32.1,72.8 33.8,73.8 C35.5,74.8 37.2,75.2 39.2,75.2 C41.6,75.2 44,74.8 46.2,73.8 C48.3,72.9 50.3,71.9 52.3,70.9 C54.4,69.9 62.7,65.8 63.7,65.1 C67.2,62.7 70.7,60.2 74.3,58 C77.4,56.1 79,53.6 78.9,50 C78.9,49.9 78.9,49.7 78.9,49.6 C79.7,40.4 79,31.2 76.2,22.2 Z M64,15.3 C65.7,16.1 67.4,16.9 68.6,18.3 C68.4,18.6 68.4,19 68.2,19.1 C64.6,20.9 61.1,22.7 57.5,24.4 C55.4,23.4 54.2,21.7 52.9,19.8 C53.6,19.2 54.3,18.6 55,18.3 C57.1,17.3 59.4,16.4 61.5,15.4 C62.3,14.9 63.1,14.9 64,15.3 Z M37,3.9 C41.8,3.4 46.4,4.3 50.8,6.3 C49,8.5 47.1,9.5 40.3,12.3 C37.4,10.3 34.5,8.3 31.3,6.2 C33.1,4.3 35.1,4.1 37,3.9 Z M24.3,8.1 C26.2,7 28.1,7 30,8.1 C30.4,8.3 30.9,8.6 31.3,8.9 C33.4,10.5 35.4,12.1 37.5,13.7 C36.1,15.3 34.6,16.4 32.9,17.3 C31.6,18 30.5,17.9 29.4,17 C28.8,16.5 28.2,16.1 27.7,15.5 C26,13.7 24.3,12.2 21.9,11.6 C21.6,11.5 21.4,11.1 21.1,10.8 C21.9,9.5 23.1,8.8 24.3,8.1 Z M16.5,62.9 C14.9,63.2 13.6,62.3 12.3,61.7 C7.1,59.6 4.1,55.7 3.7,50 C3.5,46.9 3.4,43.8 3.4,40.7 C3.5,35.6 3.7,30.5 3.9,25.2 C5.3,24.9 6.2,25.5 6.9,26.1 C8.5,27.4 10.2,28.3 12.1,29.1 C12.6,29.3 13,29.5 13.5,29.7 C15.1,30.5 15.9,31.7 15.8,33.6 C15.7,37.8 15.7,42.1 15.8,46.3 C15.9,50.9 16.2,55.5 16.4,60.1 C16.5,61 16.5,61.9 16.5,62.9 Z M5.5,22 C8.6,18.1 12.8,15.7 16.6,12.7 C21.5,13.6 25.3,15.7 28.7,19.1 C25.1,22.7 20.5,24.9 17.1,28.5 C13.5,27.3 7.5,24 5.5,22 Z M23.1,53 C23,56.1 23.1,59.3 23,62.4 C23,63.5 22.8,64.6 22.6,66.1 C21.5,65.8 20.8,65.6 20.3,65.4 C19.5,65.1 19.1,64.6 19,63.7 C19,63.5 19,63.2 19,62.9 C18.6,55.1 18,47.4 18.3,39.6 C18.4,36.6 18.8,33.6 19,30.8 C26.1,23.3 45,11.8 54.5,9.2 C56.4,9.9 57.4,11.4 58.5,13.1 C57.3,13.7 56.2,14.3 55.1,14.9 C49.1,18.1 43.2,21.3 37.2,24.5 C35.3,25.5 33.6,26.7 31.8,27.9 C27.4,30.7 25.1,34.8 24.2,39.9 C23.3,44.2 23.2,48.6 23.1,53 Z M40.9,27.2 C42.4,27.8 43.8,28.5 44.5,30.2 C41.8,32 39.3,33.7 36.5,35.6 C34.6,34.6 33.3,33.3 31.6,32 C33.5,30.4 35.1,29.1 36.7,27.7 C38,26.7 39.4,26.6 40.9,27.2 Z M37.6,71.2 C35.2,71.4 33.4,70.3 31.4,69.6 C29.5,69 27.7,68.2 25.7,67.4 C25.7,59.7 24.9,52 25.8,44.4 C26.2,41.1 26.8,37.7 28.5,34.7 C31.6,34.2 33.4,35.9 34.4,38.4 C35.3,40.7 35.9,43.2 36.2,45.7 C36.7,50.4 36.9,55.2 37.2,59.9 C37.4,62.7 37.5,65.4 37.6,68.2 C37.6,69.1 37.6,70.1 37.6,71.2 Z M51.8,53.3 C51.6,57.9 51.4,62.5 51.1,67.2 C51.1,67.6 51,67.9 50.9,68.2 C47.5,70.8 44.3,71.9 40.4,72 C39.6,68.4 39.9,64.6 39.4,61 C39,57.3 38.9,53.5 38.6,49.8 C38.3,46.1 37.8,42.4 37.4,38.4 C39.6,35.8 42.1,34 45,32.7 C46.6,32 47.6,32.3 48.5,33.7 C50.1,36.1 50.7,39 51.3,41.8 C52,45.5 51.9,49.4 51.8,53.3 Z M59,54.3 C58.4,57.9 58.1,61.5 57.6,65.2 C56.8,66 55.9,66.8 54.5,66.9 C53.4,66.2 53.8,65.1 53.8,64.2 C53.9,58.6 54.1,52.9 54.2,47.3 C54.3,43.7 53.8,40.1 52.9,36.5 C52.1,33.3 50.5,30.8 47.8,28.8 C46.2,27.6 44.6,26.4 42.5,24.7 C44.1,23.6 45.2,22.7 46.3,22 C48.2,21 49.4,21.3 51.1,22.6 C53.9,24.9 55.8,27.8 56.8,31.2 C59.3,38.8 60.4,46.4 59,54.3 Z M76.4,50.5 C76.2,52 75.6,53 74.5,54 C70.3,57.6 65.6,61 61.3,63.1 C61.1,62.4 60.7,61.8 60.7,61.2 C60.8,59.3 60.9,57.4 61.3,55.6 C63.5,46.4 62.4,37.5 58.8,28.8 C58.7,28.5 58.6,28.1 58.5,27.7 C58.5,27.6 58.5,27.5 58.5,26.9 C62.8,23.5 67.2,20.5 73.2,21.1 C73.5,21.7 73.8,22.2 74,22.8 C77.1,31.8 77.6,41.1 76.4,50.5 Z M62.5,29.9 C62.9,31.9 63.3,33.9 63.8,35.8 C63.9,36.3 64.1,36.8 64.3,37.2 C64.7,37.9 65.3,38.4 66.1,38.3 C69.5,37.9 72.7,37 75.2,34.2 C73.8,31.4 73.8,28.2 72.4,25 C69.4,27.7 65.3,27.2 62.5,29.9 Z M65.8,35.3 C65.5,33.8 65.2,32.7 64.9,31.5 C66.7,30.3 68.5,29.2 70.6,28.5 C71.9,30.2 72.2,31.9 72.2,33.9 C70.3,35.1 68.2,35.3 65.8,35.3 Z" id="Shape" fill="#000000" fill-rule="nonzero"></path>
    </g>
  </svg>
</div>

<h2 id="pre-rails-6">Pre-Rails 6</h2>
<p>The JavaScript was compiled with Sprockets Rails by default and resided in <code class="language-plaintext highlighter-rouge">app/assets/javascripts</code> directory. Stubs would be created when using scaffold generators.</p>

<p>With Rails 5.1 and up, we would provide an option to use Webpacker as the compiler while creating a new rails application,</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rails new myapp --webpack
</code></pre></div></div>

<p>Or to use it with existing Rails application,</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Gemfile
gem 'webpacker', '~&gt; 4.x'
</code></pre></div></div>

<p>And then install it with the Rails application,</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bundle
bundle exec rails webpacker:install
</code></pre></div></div>

<hr />

<h2 id="rails-6-onwards">Rails 6 onwards…</h2>
<p>When we create a new application with Rails 6, the Webpacker gem will be installed and <code class="language-plaintext highlighter-rouge">webpacker:install</code> will be run by the Rails application generator.</p>

<p>By default, The <code class="language-plaintext highlighter-rouge">app/javascript</code> directory will host the JavaScript files. The existing JavaScript code for Active Storage, Action Cable, Turbolinks, and Rails-UJS will be loaded by a new <code class="language-plaintext highlighter-rouge">application.js</code> pack in <code class="language-plaintext highlighter-rouge">app/javascript</code> directory.</p>

<p>The Action Cable stubs will be created in the <code class="language-plaintext highlighter-rouge">app/javascripr/channels</code> directory and will use ES6 instead of CoffeeScript. Note that no other JavaScript stubs will be created by default when using the scaffold generators.</p>

<h2 id="what-is-webpacker">What is Webpacker?</h2>
<p>Webpacker is a gem which allows easy integration of JavaScript pre-processor and bundler with Rails. It provides various helpers and configuration options to use webpack easily with Rails.</p>

<p>Webpacker directory structure with Rails 6 the app/javascript directory contains:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>app/javascript:
  ├── channels:
  │   # action cable channel files here
  │   └── consumer.js
  │   └── index.js
  ├── packs:
  │   # only webpack entry files here
  │   └── application.js
</code></pre></div></div>

<p>The packs directory contains entry points for webpack. All the files in the packs directory are compiled by Webpacker. The <code class="language-plaintext highlighter-rouge">application.js</code> pack by default includes JavaScript code for Active Storage, Action Cable, Turbolinks, and Rails-UJS,</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>require("@rails/ujs").start()
require("turbolinks").start()
require("@rails/activestorage").start()
require("channels")
</code></pre></div></div>

<h2 id="how-to-use-webpacker-with-packs">How to use Webpacker with packs?</h2>

<p>With the help of packs, Webpacker provides a convenient way to access and use JavaScript required for different layouts in the Rails application. The packs can be accessed via helper methods <code class="language-plaintext highlighter-rouge">javascript_pack_tag</code> and if css styles are being imported in pack files, <code class="language-plaintext highlighter-rouge">stylesheet_pack_tag</code>.</p>

<p>For instance, with Rails 6, the <code class="language-plaintext highlighter-rouge">app/javascript/packs/application.js</code> pack will be included by default in <code class="language-plaintext highlighter-rouge">app/views/layouts/application.html.erb</code> layout as follows:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;%= javascript_pack_tag 'application', 'data-turbolinks-track': 'reload' %&gt;
</code></pre></div></div>

<p>It is encouraged to place the actual application logic in a relevant structure within app/javascript and only use the pack files to reference that code so that webpack knows it needs to be compiled.</p>

<h2 id="how-to-configure-webpacker">How to configure Webpacker?</h2>

<p>The configuration information for Webpacker lies in <code class="language-plaintext highlighter-rouge">config/webpacker.yml</code>. We can change options like source path, packs path and many more from the configuration file.</p>

<p>The environment specific JavaScript configuration files for webpack can be found at <code class="language-plaintext highlighter-rouge">config/webpack</code> directory. More on webpack configuration with Webpacker here.</p>

<h2 id="compilation">Compilation</h2>

<p>Keeping the process similar to the previous assets pipeline, the JavaScript compilation happens along with the request while running the Rails server in development mode.</p>

<p>In production mode rake assets:precompile does the job. The <code class="language-plaintext highlighter-rouge">assets:precompile</code> rake task runs <code class="language-plaintext highlighter-rouge">webpacker:compile</code> by default to generate webpack compiled assets.</p>

<p>We can also use live reloading and hot module replacement in development mode with the help of binstubs provided by Webpacker.</p>

  </div>
</div>


    <div class="py-20 grid justify-center">
  <div class="w-full flex align-middle space-x-4">
    <a href="https://www.linkedin.com/in/alanr3id/" title="LinkedIn">
      <i class="fab fa-linkedin-in text-xl text-blue-600"></i>
    </a>
    <a href="https://twitter.com/alan_r3id" target="_blank" title="Twitter">
      <i class="fab fa-twitter text-xl text-blue-300"></i>
    </a>
    <a href="https://dribbble.com/r3id" target="_blank" title="Dribbble">
      <i class="fab fa-dribbble text-xl text-pink-600"></i>
    </a>
    <a href="https://github.com/r3id" target="_blank" title="GitHub">
      <i class="fab fa-github text-xl text-black"></i>
    </a>
    <a href="https://medium.com/@r3id" target="_blank" title="Medium">
      <i class="fab fa-medium text-xl text-black"></i>
    </a>
  </div>
  <p class="pt-5 pb-5 text-xs font-medium text-center text-gray-400 dark:text-gray-200">
    <a href="/privacy">Privacy</a>
  </p>
  <p class="pt-5 pb-5 text-xs font-medium text-center text-gray-300 dark:text-gray-200">
    © 2021 Alan Reid
  </p>
</div>


    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-68933763-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-68933763-1');
    </script>
  </body>
</html>
